# Maintainer: th3cavalry <github.com/th3cavalry>
pkgname=gz302-control-center
pkgver=4.0.0
pkgrel=1
pkgdesc="Linux optimization suite and control center for ASUS ROG Flow Z13 (GZ302)"
arch=('any')
url="https://github.com/th3cavalry/GZ302-Linux-Setup"
license=('MIT')
depends=('python' 'python-pyqt6' 'python-psutil' 'libusb' 'libnotify' 'ryzenadj')
optdepends=('steam: Gaming support' 'ollama: AI support')
source=("${url}/archive/refs/heads/main.zip")
sha256sums=('SKIP')

package() {
    cd "$srcdir/GZ302-Linux-Setup-main"
    
    # Install binaries
    install -Dm755 scripts/gz302-rgb.sh "$pkgdir/usr/local/bin/gz302-rgb"
    install -Dm755 scripts/gz302-rgb-window.py "$pkgdir/usr/local/bin/gz302-rgb-window"
    
    # Install libs
    install -d "$pkgdir/usr/local/share/gz302/lib"
    cp -r gz302-lib/* "$pkgdir/usr/local/share/gz302/lib/"
    
    # Install Tray App
    install -d "$pkgdir/usr/local/share/gz302/tray-icon"
    cp -r tray-icon/* "$pkgdir/usr/local/share/gz302/tray-icon/"
    
    # Install udev rules
    install -Dm644 scripts/99-gz302-rgb.rules "$pkgdir/etc/udev/rules.d/99-gz302-rgb.rules" # Needs to be created
    
    # Install desktop file
    install -Dm644 tray-icon/gz302-tray.desktop "$pkgdir/usr/share/applications/gz302-control-center.desktop"
}
